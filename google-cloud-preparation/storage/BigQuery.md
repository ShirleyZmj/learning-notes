### **BigQuery 数据加载方式**  

BigQuery 提供 **多种方式** 来加载数据，主要分为 **批量加载（Batch Loading）**、**流式加载（Streaming API）** 和 **数据流管道（Dataflow + Apache Beam）**。  

---

### **1. 批量加载（Batch Loading）**  
**特点**：
- **单次操作** 完成数据加载。  
- 适用于 **CSV 文件、数据库导出、日志文件** 等静态数据。  
- **适用于变更较慢的数据**，例如每日批量数据同步。  
- **批量加载免费**，无额外费用。  

**实现方式**：
1. **创建加载作业（Load Job）**。  
2. **使用 BigQuery Data Transfer Service**（从 SaaS 产品导入数据，最简单）。  
3. **使用 Cloud Composer**（Google Cloud 托管的 Apache Airflow）。  
4. **使用 `bq` 命令行工具**，结合 `cron` 进行定时任务。  
5. **使用 BigQuery 连接器**（适用于 **Spark、Hadoop** 等大数据产品）。  

---

### **2. 流式加载（Streaming API）**  
**特点**：
- **实时写入数据**，数据可 **立即查询**。  
- 适用于 **应用事件跟踪、日志流** 等 **实时数据场景**。  
- 按 **数据写入量** 计费，费用比批量加载高。  

**适用场景**：
- **跟踪应用事件**（例如用户点击、交易数据）。  
- **日志流处理**（实时分析服务器日志）。  

---

### **3. Dataflow + Apache Beam**  
**特点**：
- 定义 **数据处理管道（ETL）**，支持 **数据转换和清洗**。  
- 适用于 **触发式数据处理**，例如 **事件驱动的 Cloud Run 函数**。  
- **可用于批量和流式数据处理**。  

**示例应用**：
- **Cloud Run 触发 Apache Beam**，然后 **使用 Dataflow 处理数据并存入 BigQuery**。  
- **数据转换**（例如：格式转换、数据清洗）。  

---

### **4. 直接执行 SQL 查询（Federated Queries & CTAS）**  
**特点**：
- **查询外部数据源**，然后 **保存结果** 到 BigQuery 表。  
- **支持 Federated Queries**，可查询 **Cloud Storage、Cloud SQL、Bigtable** 等外部数据。  
- **CTAS（CREATE TABLE AS SELECT）**：直接用 SQL 语句创建表并插入查询结果。  

**适用场景**：
- **基于 SQL 处理数据**，无需额外数据转换工具。  

---

### **5. 第三方应用连接器**  
**特点**：
- 许多 **第三方工具（如 Salesforce、Looker）** 提供 **BigQuery 连接器**，可直接同步数据。  
- 需查看 **各产品的官方文档** 进行配置。  

---



### **BigQuery 数据加载方式对比表**  

| **加载方式**                 | **适用场景**                    | **特点**                                        | **付费情况**               |
|----------------------------|-------------------------------|------------------------------------------------|---------------------------|
| **批量加载（Batch）**        | **定期数据导入（CSV、数据库导出）** | **免费，适合大批量数据**，适用于**变化较慢**的数据 | **免费**（无数据加载费用）  |
| **流式加载（Streaming API）** | **实时日志、事件数据**          | **数据可立即查询**，适用于**实时数据分析**      | **按数据写入量计费**        |
| **Dataflow + Apache Beam**   | **数据转换和清洗（ETL）**       | **支持批量 & 实时**，适用于**事件驱动数据管道**  | **Dataflow 按计算资源计费** |
| **SQL 查询（Federated & CTAS）** | **查询外部数据源，存入 BigQuery** | **基于 SQL 直接处理数据**                      | **查询和存储均按使用量计费** |
| **第三方连接器**              | **SaaS 产品（Salesforce、Looker）** | **查看第三方工具文档进行配置**                 | **取决于具体工具**          |

其中：
- **批量加载免费**，但存储数据会产生存储费用。  
- **流式加载按写入数据量计费**，一般比批量加载成本更高。  
- **Dataflow & Apache Beam 需要计算资源**，因此按运行时间和计算量收费。  
- **SQL 查询 & CTAS 需要计算查询成本**，按 **查询数据量和存储大小** 计费。  
- **第三方连接器费用取决于提供商**，需要查看各工具的具体定价。